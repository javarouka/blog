<!DOCTYPE html><html><head><meta charset="utf-8"><title>IE 이벤트 모델의 메모리 누수 | NonBlock</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="IE 이벤트 모델의 메모리 누수"><meta property="og:type" content="article"><meta property="og:title" content="IE 이벤트 모델의 메모리 누수"><meta property="og:url" content="https://blog.javarouka.me/2012/07/30/event-ie/index.html"><meta property="og:site_name" content="NonBlock"><meta property="og:description" content="IE 이벤트 모델의 메모리 누수"><meta property="og:locale" content="ko_KR"><meta property="og:image" content="https://blog.javarouka.me/asset/images/js.jpg"><meta property="article:published_time" content="2012-07-29T15:00:00.000Z"><meta property="article:modified_time" content="2020-09-22T04:18:02.865Z"><meta property="article:author" content="JavaRouka"><meta property="article:tag" content="javascript"><meta property="article:tag" content="browser"><meta property="article:tag" content="ie"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://blog.javarouka.me/asset/images/js.jpg"><link rel="apple-touch-icon" sizes="57x57" href="/fav/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/fav/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/fav/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/fav/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/fav/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/fav/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/fav/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/fav/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/fav/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/fav/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/fav/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/fav/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/fav/favicon-16x16.png"><link rel="manifest" href="/fav/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/fav/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><meta name="keywords" content="javascript,browser,ie"><link href="https://fonts.googleapis.com/css?family=Lato:400,400i,700" rel="stylesheet"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-85661914-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-85661914-1")</script><link rel="stylesheet" href="/icomoon/style.css"><link rel="stylesheet" href="/style.css"><script type="text/javascript">var __sauron=__sauron||[];__sauron.push(["pageview"]),function(){var e="https://analy1.sauroneyes.com/";__sauron.push(["setTrackerUrl",e+"analytics/"]);var a=document,r=a.createElement("script"),s=a.getElementsByTagName("script")[0];r.type="text/javascript",r.async=!0,r.defer=!0,r.src=e+"js/sauron.js",s.parentNode.insertBefore(r,s)}()</script><meta name="generator" content="Hexo 5.2.0"><link rel="stylesheet" href="/css/prism.css" type="text/css"><link rel="alternate" href="/atom.xml" title="NonBlock" type="application/atom+xml">
</head><body><div class="site-wrapper"><div id="loading-bar-wrapper"><div id="loading-bar"></div></div><script>document.getElementById("loading-bar").style.width="20%"</script><header id="header" class="site-header clearfix"><a class="logo square clearfix" href="/"><span class="b">N </span><span class="w">o </span><span class="b">n </span><span class="b">B </span><span class="b">l </span><span class="w">o </span><span class="b">c </span><span class="w">k </span></a><a class="me square site-nav-switch clearfix"><span class="b"><span class="icon icon-menu"></span></span></a></header><aside class="category-wrapper"><div class="site-category"><a class="nav flex-column-link" href="/categories/effective-java/">Effective Java</a><a class="nav flex-column-link" href="/categories/review/">Review</a><a class="nav flex-column-link" href="/categories/tech/">Tech</a><a class="nav flex-column-link" href="/categories/tech/translate/">Translate</a><a class="nav flex-column-link" href="/categories/book/">book</a><a class="nav flex-column-link" href="/categories/java/">java</a><a class="nav flex-column-link" href="/categories/java/kotlin/">kotlin</a><a class="nav flex-column-link" href="/categories/javascript/">javascript</a><a class="nav flex-column-link" href="/categories/javascript/react/">react</a><a class="nav flex-column-link" href="/categories/javascript/react/redux-saga/">redux-saga</a><a class="nav flex-column-link" href="/categories/kotlin/">kotlin</a><a class="nav flex-column-link" href="/categories/kotlin/tech/">tech</a><a class="nav flex-column-link" href="/categories/kotlin/tech/translate/">translate</a></div><div class="search"><form name="searchform" id="searchform" class="u-search-form"><input type="text" id="searchinput" class="u-search-input st-default-search-input" data-list-highlight="true" data-list-value-completion="true" placeholder="Looking for something in this blog?"> <button type="submit" id="u-search-btn-submit" class="u-search-btn-submit"><span class="icon icon-search"></span></button></form></div><script>document.getElementById("loading-bar").style.width="40%"</script><main id="main" class="clearfix"><article id="post-event-ie" class="article white-box article-type-post" itemscope itemprop="blogPost"><header class="article-header"><h1 class="article-title" itemprop="name">IE 이벤트 모델의 메모리 누수</h1><h2 class="article-sub-title">IE 이벤트 모델의 메모리 누수</h2><div class="article-meta">Posted on <time class="article-time" datetime="2012-07-29T15:00:00.000Z" itemprop="datePublished">2012-07-30</time></div></header><div class="article-entry" itemprop="articleBody"><p>표준 스크립트 엔진과 다르게 마이크로소프트의 JScript 엔진은 클로저(Closure)에 대해 제대로 처리해주지 못하기에 메모리 Leak이 발생하는건 잘 알려져 있습니다.</p><p>JScript가 자바스크립트 객체와 DOM 간의 순환 참조 (circular reference) 가 발생할 때, 가비지 컬렉팅을 제대로 수행해주지 못하기 때문입니다.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 순환 참조 코드</span></span><br><span class="line"><span class="comment">// 정상적인 엔진은 이것을 Closure로 이해하며 엘리먼트가 </span></span><br><span class="line"><span class="comment">// 참조를 잃을 경우 카비지 컬렉팅 된다.</span></span><br><span class="line"><span class="comment">// 그러나 JScript 는 순환 참조로 인식하여 </span></span><br><span class="line"><span class="comment">// 서로 참조를 기억하고 컬렉팅되지 않는다.</span></span><br><span class="line"><span class="keyword">var</span> actionButton = <span class="built_in">document</span>.createElement(<span class="string">&quot;button&quot;</span>);</span><br><span class="line">actionButton.innerHTML = <span class="string">&quot;Click Me&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> pullhandler = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// Element가 Handler에서 참조. Closure.</span></span><br><span class="line">    actionButton.innerHTML = <span class="string">&quot;Pushed&quot;</span>; </span><br><span class="line">    pullContent();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// Handler를 Element 가 참조.</span></span><br><span class="line">actionButton.onclick = pullhandler; </span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.body.appendChild(actionButton);</span><br></pre></td></tr></table></figure><p>DOM 객체가 이벤트 핸들링 함수같은 자바스크립트 객체를 참조하고, 그 자바스크립트 객체는 DOM 객체를 참조할 때, 클로저가 형성됩니다. 클로저를 잘 이해하는 표준 스크립트 엔진은 이를 잘 처리하여 DOM객체나 자바스크립트 객체로 향하는 다른 참조가 없을 경우 가비지 컬렉팅이 되며 메모리를 해제합니다.</p><p>보통 innerHTML 등으로 컨텐트가 없어질 때, removeChild 등으로 엘리먼트가 삭제될 때, 페이지 언로드시 등등에서 발생하지요. 그러나 IE의 JScript의 경우 이러한 가비지 컬렉팅 사이클을 잘못 처리합니다. 사용된 순환 참조가 많을수록 암세포처럼 메모리를 잠식하며 결국엔 브라우저는 죽습니다.</p><p>제일 쉬운 해결 방법은 어떤 이유로 객체가 제거될 때, 명시적으로 null 을 주는 것입니다.</p><p>try-catch-finally 구문으로 줄 수도 있고, purge 함수를 구현하여 명시적인 해지를 시킬 수도 있습니다.</p><p>순환 참조에 대해서는 다음 자료를 참고하면 좋을 것 같습니다.<br><a target="_blank" rel="external nofollow noopener noreferrer" href="http://www.slideshare.net/tifftiff/memory-leaks-in-ie">http://www.slideshare.net/tifftiff/memory-leaks-in-ie</a> (PT, 영문, 추천)</p><p>최근 IE8에 와서는 문제가 수정되었다고 하네요. (IE7 이하는 아직 문제가 많기에 하위호환이 필요한 경우는 고려가 필요합니다.)</p></div><div class="article-tags"><a class="tag-none-link" href="/tags/browser/" rel="tag">browser</a><a class="tag-none-link" href="/tags/ie/" rel="tag">ie</a><a class="tag-none-link" href="/tags/javascript/" rel="tag">javascript</a></div><section id="comments" class="white-box"><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></section></article><script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5bf3f68d0a53e4d6"></script><script>document.getElementById("loading-bar").style.width="60%"</script></main><footer id="footer" class="clearfix"><div>&copy; <a href="https://blog.javarouka.me">NonBlock</a> Theme by <a href="http://artifact.me/" target="_blank" rel="external nofollow noopener noreferrer">Art Chen</a>.</div><div>Powered by <a target="_blank" href="https://hexo.io/" rel="external nofollow noopener noreferrer">Hexo</a>.</div></footer><script>document.getElementById("loading-bar").style.width="80%"</script><div class="overlay"></div></aside></div><div class="site-sidebar"><div class="sidebar-switch clearfix" style="display:none"><a class="dark-btn active" data-toggle="toc"><span class="icon icon-list"></span> <span class="text">Index</span> </a><a class="dark-btn" data-toggle="bio"><span class="icon icon-person"></span> <span class="text">Bio</span></a></div><div class="site-bio show" style="display:block"><div class="about-me clearfix"><div class="avatar"><img src="https://avatars2.githubusercontent.com/u/1438503?v=4&s=250"></div><div class="info"><a class="name dark-btn" href="/about">JavaRouka</a></div><div class="info"><span class="item desc">javarouka 의 기술블로그</span></div></div><div class="social clearfix"><a href="/atom.xml" class="feed" target="_blank" rel="external"><span class="icon icon-feed"></span> </a><a href="mailto:javarouka@gmail.com" class="mail" target="_blank" rel="external nofollow noopener noreferrer"><span class="icon icon-mail"></span> </a><a href="https://github.com/javarouka" class="github" target="_blank" rel="external nofollow noopener noreferrer"><span class="icon icon-github"></span> </a><a href="https://www.facebook.com/hanghui.i" class="facebook" target="_blank" rel="external nofollow noopener noreferrer"><span class="icon icon-facebook"></span></a></div><div class="shortcuts clearfix"><div class="bk"><a href="#header" class="dark-btn window-nav"><span class="icon icon-chevron-thin-up"></span> <span class="text">Back to Top</span></a></div><div class="bk"><a href="#footer" class="dark-btn window-nav"><span class="icon icon-chevron-thin-down"></span> <span class="text">Go to Bottom</span></a></div></div></div><div class="site-post-nav show" style="display:block"><div class="site-post-nav-box"><a href="/2012/07/30/nodejs-com/" class="icon icon-chevron-thin-left"><a href="/2012/07/30/nodejs-com/" class="site-post-nav-text">Node.js에 대한 두 블로거의 다른 관점</a></a></div><div class="site-post-nav-box"><a href="/2012/07/30/book-spring-in-action/" class="site-post-nav-text">[리뷰] - Spring in Action 3th Edition</a> <a href="/2012/07/30/book-spring-in-action/" class="icon icon-chevron-thin-right"></a></div></div><div class="site-toc" style="display:none"><div class="no-index">No Index</div></div></div><script type="text/javascript">var GOOGLE_CUSTOM_SEARCH_API_KEY="",GOOGLE_CUSTOM_SEARCH_ENGINE_ID="",ALGOLIA_API_KEY="",ALGOLIA_APP_ID="",ALGOLIA_INDEX_NAME="",AZURE_SERVICE_NAME="",AZURE_INDEX_NAME="",AZURE_QUERY_KEY="",BAIDU_API_ID="",SEARCH_SERVICE="hexo"</script><script src="https://code.jquery.com/jquery-2.1.4.min.js"></script><script>window.jQuery||document.write('<script src="/js/jquery.js"><\/script>')</script><script src="/js/search.js"></script><script src="/js/app.js"></script><script type="text/javascript">var disqus_shortname="https-javarouka-github-io",disqus_url="https://blog.javarouka.me/2012/07/30/event-ie/";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}()</script><script>document.getElementById("loading-bar").style.width="100%"</script></body></html>